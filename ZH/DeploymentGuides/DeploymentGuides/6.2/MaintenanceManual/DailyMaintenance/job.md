# 作业平台

本文描述作业平台在日常运维中遇到的问题，排查思路和解决方案。

## 常见问题

### 本地文件上传提示"can not find agent by src ip x.x.x.x"

问题原因：

作业平台调用管控平台接口时，传递自身的内网 ip 地址有误。

> 本地文件上传的原理是，前端将文件传给作业平台后台，作业平台落地到本机的磁盘目录，然后调用管控平台的文件分发接口分发。 调用文件分发接口时需要传递本机 IP 地址，该 IP 地址需要是正常安装了 gse_agent 且状态正常。 作业平台的 `job-execute` 模块在启动时，经过一系列的逻辑，会尽可能自动获取到正确的内网 IP 地址。但是如果用户部署 `job_execute` 的主机存在多个内网 ip 地址，且尚未安装 agent 的时，`job_execute` 可能随机获取到一个不正确的内网 IP 地址。

解决方案：

- 安装《蓝鲸》业务下服务器的 agent 后，重启下 job 服务器的 `bk-job-execute`服务：`systemctl restart bk-job-execute`，触发它启动阶段自动获取正确内网 IP 地址的逻辑。
