# **宝可拉--通过按量计费的编译加速方案提升服务器端75%编译速度**

||
|:-|
|**涉及产品：** BKCI流水线；编译加速Turbo|
|**场景标签：** 按量计费的编译加速方案；C++代码编译；Windows Subsystem for Linux 场景下的编译加速|
|**解决的问题：**  C++代码编译速度慢|


上海宝可拉网络科技有限公司成立于2021年上海，是由知名制作人陈敏创建。公司专注于大型高精尖MMORPG/ARPG领域，CEO陈敏曾负责过《龙之谷手游》和《仙境传说·爱如初见》（韩服《RagnarokOringin》）手游，有着连续两款成功的爆款项目经验。
在与宝可拉的沟通中我们了解到，随着开发进度推进，宝可拉在服务器端的开发效率开始逐渐受到了编译效率的影响：
1. 服务器端（C++）单次全量编译耗时近16分钟，**编译期间占用开发机资源**
2. 市场上主流的**商业编译加速软件的软件授权费用高**，**对于Windows Subsystem for Linux场景下的编译加速支持有限**

**基于宝可拉的描述，我们向宝可拉推荐了能够按量计费的BKCI编译加速（Turbo）。BKCI编译加速是由BKCI基于分布式编译技术、缓存技术、容器技术实现的一套编译解决方案。** 在编译加速方案交付后，宝可拉对其服务器端（C++）构建进行了测试，发现无论是从编译速度还是使用成本，该方案都有明显的效果：

1. **单次编译时长从原来的16分钟缩短到4分钟，加速比达到75%。**
2. **使用成本只有600元/月（计算方式详见附录，实际费用根据每月编译量浮动），比起某主流的商业软件有着巨大的成本优势。**

![](../../../assets/image-casestudy-bokura-1.jpg)

针对编译加速的效果，宝可拉的服务器端开发负责人说道：“BKCI的编译加速相较于我们试用的商业软件，更好地支持了WSL环境下编译任务的加速问题。同时编译加速按实际用量计费的模式，让我们可以以非常低廉的成本，对服务器端编译工作进行加速，对于我们后端开发的工作效率有了极大的提升！”


接下来，BKCI将持续对C++的编译效果以及成本进行优化并开始探索对客户端UE4代码编译进行加速的方案，敬请期待！


 <br> <br> 
**附录：使用成本估算**

编译加速Turbo计算资源（4C8G*24副本）成本：

CPU 每核0.055元/小时 * 4C * 24副本 / 60分钟 = 0.088 元/分钟

内存 每G 0.032元/小时 * 8G * 24副本 / 60分钟 = 0.1024 元/分钟

单次加速共4分钟的成本 （0.088 + 0.1024） * 4 = 0.76元 

编译加速Turbo每月成本预估：

20次构建/天  * 20天/月 * 0.76元/次 + 300元/月（VPN费用） =  600元/月

某主流商业软件每月成本预估：

10美金/核/月 * 16核 * 5台开发机 ≈ 5000元/月